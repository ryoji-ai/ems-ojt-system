<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="救急OJT教育システム 管理者マニュアル">
    <meta name="theme-color" content="#1a365d">
    <title>管理者マニュアル - 救急OJT教育システム</title>
    <style>
        :root {
            --primary-color: #c41e3a;
            --primary-dark: #9a1830;
            --primary-light: #e8475f;
            --primary-subtle: rgba(196, 30, 58, 0.08);
            --secondary-color: #1a365d;
            --secondary-light: #2d4a7c;
            --text-color: #1a202c;
            --text-secondary: #4a5568;
            --text-light: #718096;
            --text-muted: #a0aec0;
            --bg-color: #f7f8fc;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --border-light: #edf2f7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', Meiryo, sans-serif;
            background-color: var(--bg-color);
            background-image:
                radial-gradient(ellipse at 20% 0%, rgba(196, 30, 58, 0.03) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(26, 54, 93, 0.03) 0%, transparent 50%);
            background-attachment: fixed;
            color: var(--text-color);
            line-height: 1.8;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
        }

        .header {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #243b5e 50%, var(--secondary-light) 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 4px 12px rgba(26, 54, 93, 0.15);
            border-bottom: 3px solid var(--primary-color);
        }

        .header h1 { font-size: 1.2rem; font-weight: 700; letter-spacing: 0.02em; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .header .subtitle { font-size: 0.85rem; opacity: 0.8; margin-top: 4px; }

        .back-link {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.9rem;
            padding: 6px 10px;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.15);
            transition: 0.2s ease;
        }
        .back-link:hover { background: rgba(255,255,255,0.2); }

        .container { max-width: 800px; margin: 0 auto; padding: 20px; }

        .toc {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-light);
        }
        .toc h2 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }
        .toc h2::after {
            content: '';
            position: absolute;
            bottom: -2px; left: 0;
            width: 60px; height: 2px;
            background: var(--primary-color);
        }
        .toc ol { padding-left: 24px; }
        .toc li { margin: 8px 0; }
        .toc a { color: var(--text-color); text-decoration: none; transition: 0.2s ease; }
        .toc a:hover { color: var(--primary-color); text-decoration: underline; }

        .section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-light);
        }
        .section h2 {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            font-weight: 700;
        }
        .section h2::after {
            content: '';
            position: absolute;
            bottom: -2px; left: 0;
            width: 60px; height: 2px;
            background: var(--primary-color);
        }
        .section h3 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-color);
            margin: 20px 0 12px 0;
            padding-left: 12px;
            border-left: 4px solid var(--primary-color);
        }
        .section p { margin-bottom: 12px; color: var(--text-secondary); }

        .step-list {
            list-style: none;
            padding: 0;
            counter-reset: step-counter;
        }
        .step-list li {
            counter-increment: step-counter;
            padding: 16px 16px 16px 60px;
            margin: 12px 0;
            background: var(--bg-color);
            border-radius: 12px;
            position: relative;
            border: 1px solid var(--border-light);
        }
        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 16px; top: 50%;
            transform: translateY(-50%);
            width: 32px; height: 32px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 2px 6px rgba(196, 30, 58, 0.25);
        }

        .note {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 1px solid #fde68a;
            border-left: 4px solid #f39c12;
            padding: 12px 16px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
        }
        .note-title { font-weight: 700; color: #92400e; margin-bottom: 4px; }

        .tip {
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
            border: 1px solid #a7f3d0;
            border-left: 4px solid #27ae60;
            padding: 12px 16px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
        }
        .tip-title { font-weight: 700; color: #065f46; margin-bottom: 4px; }

        .warning {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border: 1px solid #fecaca;
            border-left: 4px solid #dc3545;
            padding: 12px 16px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
        }
        .warning-title { font-weight: 700; color: #991b1b; margin-bottom: 4px; }

        /* コードブロック */
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.88rem;
            line-height: 1.7;
            overflow-x: auto;
            position: relative;
        }
        .code-block .comment { color: #94a3b8; }
        .code-block .key { color: #7dd3fc; }
        .code-block .string { color: #86efac; }
        .code-block .cmd { color: #fbbf24; }

        .code-label {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            font-size: 0.75rem;
            padding: 2px 10px;
            border-radius: 6px 6px 0 0;
            font-family: 'Consolas', 'Courier New', monospace;
            margin-bottom: -1px;
        }

        /* ファイル構成図 */
        .file-tree {
            background: #1e293b;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.88rem;
            line-height: 1.9;
        }
        .file-tree .dir { color: #7dd3fc; }
        .file-tree .file { color: #86efac; }
        .file-tree .new { color: #fbbf24; }
        .file-tree .desc { color: #94a3b8; font-size: 0.82rem; }

        /* フローチャート */
        .flow {
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin: 16px 0;
        }
        .flow-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-color);
            border-radius: 10px;
            border: 1px solid var(--border-light);
        }
        .flow-item .flow-num {
            flex-shrink: 0;
            width: 28px; height: 28px;
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-light));
            color: white;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
            font-size: 0.85rem;
        }
        .flow-arrow {
            text-align: center;
            color: var(--primary-color);
            font-size: 1.2rem;
            padding: 2px 0;
        }

        table { width: 100%; border-collapse: collapse; margin: 16px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-color); }
        th { background: var(--bg-color); font-weight: 700; color: var(--secondary-color); }

        .badge {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .badge-blue { background: #dbeafe; color: #1e40af; }
        .badge-green { background: #d1fae5; color: #065f46; }
        .badge-yellow { background: #fef3c7; color: #92400e; }

        .footer {
            text-align: center;
            padding: 24px;
            color: var(--text-muted);
            font-size: 0.8rem;
            letter-spacing: 0.03em;
        }

        @media (max-width: 600px) {
            .container { padding: 12px; }
            .section { padding: 16px; }
            .step-list li { padding: 12px 12px 12px 52px; }
            .code-block { font-size: 0.8rem; }
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #0f172a;
                --card-bg: #1e293b;
                --text-color: #f1f5f9;
                --text-secondary: #cbd5e1;
                --text-light: #94a3b8;
                --text-muted: #64748b;
                --border-color: #334155;
                --border-light: #1e293b;
            }
            .header { background: linear-gradient(135deg, #0f172a, #1a2744, #1e293b); }
            .note { background: linear-gradient(135deg, #422006, #451a03); color: #fbbf24; border-color: #92400e; }
            .note-title { color: #fbbf24; }
            .tip { background: linear-gradient(135deg, #064e3b, #065f46); color: #6ee7b7; border-color: #059669; }
            .tip-title { color: #6ee7b7; }
            .warning { background: linear-gradient(135deg, #450a0a, #7f1d1d); color: #fca5a5; border-color: #dc2626; }
            .warning-title { color: #fca5a5; }
            .step-list li { background: #0f172a; border-color: #334155; }
            th { background: #0f172a; color: #e2e8f0; }
            .toc a { color: #e2e8f0; }
            .flow-item { background: #0f172a; border-color: #334155; }
            .section h3 { color: #e2e8f0; }
        }

        @media print {
            .header { position: static; background: white; color: var(--secondary-color); border-bottom: 2px solid var(--primary-color); }
            .back-link { display: none; }
            .section { box-shadow: none; border: 1px solid var(--border-color); break-inside: avoid; }
        }
    </style>
</head>
<body>
    <header class="header">
        <a href="index.html" class="back-link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            戻る
        </a>
        <h1>管理者マニュアル</h1>
        <p class="subtitle">救急OJT教育システム ― 訓練年間計画の管理・更新手順</p>
    </header>

    <div class="container">

        <!-- 目次 -->
        <nav class="toc">
            <h2>目次</h2>
            <ol>
                <li><a href="#overview">システム構成の概要</a></li>
                <li><a href="#workflow">年度初めの作業フロー</a></li>
                <li><a href="#edit-json">訓練内容の変更（JSONファイル編集）</a></li>
                <li><a href="#sync">monthly-goals.js の更新（同期スクリプト実行）</a></li>
                <li><a href="#docx">決裁用 Word 文書の生成</a></li>
                <li><a href="#deploy">GitHub へのデプロイ（サイト公開）</a></li>
                <li><a href="#next-year">翌年度への更新手順</a></li>
                <li><a href="#schema">JSON スキーマ リファレンス</a></li>
                <li><a href="#trouble">トラブルシューティング</a></li>
            </ol>
        </nav>

        <!-- 1. システム構成の概要 -->
        <section id="overview" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/>
                    <rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>
                </svg>
                1. システム構成の概要
            </h2>
            <p>訓練年間計画システムは、以下の4ファイルで構成されています。</p>

            <div class="file-tree">
ems-ojt-system/<br>
├── <span class="dir">docs/</span><br>
│   ├── <span class="new">annual-plan-2026.json</span>  <span class="desc">← 訓練内容の「マスターデータ」。ここだけ編集する</span><br>
│   ├── <span class="new">sync-monthly-goals.js</span>  <span class="desc">← JSONからmonthly-goals.jsを自動生成するスクリプト</span><br>
│   └── <span class="new">generate-annual-plan.py</span> <span class="desc">← 決裁用Word文書を生成するスクリプト</span><br>
└── <span class="dir">js/</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;└── <span class="file">monthly-goals.js</span>        <span class="desc">← サイトが参照するファイル（自動生成・手動編集不要）</span>
            </div>

            <h3>データの流れ</h3>
            <div class="flow">
                <div class="flow-item">
                    <div class="flow-num">1</div>
                    <div><strong>annual-plan-2026.json</strong> を編集する（訓練内容の入力・変更）</div>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-item">
                    <div class="flow-num">2</div>
                    <div><strong>generate-annual-plan.py</strong> を実行 → 決裁用 Word 文書が生成される</div>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-item">
                    <div class="flow-num">3</div>
                    <div>Word 文書を印刷して<strong>一括決裁</strong>（消防長〜起案者）</div>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-item">
                    <div class="flow-num">4</div>
                    <div><strong>sync-monthly-goals.js</strong> を実行 → monthly-goals.js が自動更新される</div>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-item">
                    <div class="flow-num">5</div>
                    <div><strong>git push</strong> でサイトを更新 → 以降は月が変わるたびに自動で当月の訓練が表示される</div>
                </div>
            </div>

            <div class="tip">
                <p class="tip-title">編集するファイルは1つだけ</p>
                <p><code>annual-plan-2026.json</code> を編集するだけで、Word 文書もサイトも連動して更新されます。<code>monthly-goals.js</code> を直接編集する必要はありません。</p>
            </div>
        </section>

        <!-- 2. 年度初めの作業フロー -->
        <section id="workflow" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
                2. 年度初めの作業フロー
            </h2>
            <p>毎年4月、以下の手順を行うことで年間計画が確定します。</p>

            <ol class="step-list">
                <li>
                    <strong>annual-plan-2026.json を開いて内容を確認・修正する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;">テキストエディタ（メモ帳、VS Code など）で開く。12ヶ月分のテーマ・目標・シナリオ・評価基準を確認し、必要に応じて編集する。</span>
                </li>
                <li>
                    <strong>python docs/generate-annual-plan.py を実行する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;"><code>docs/output/年間訓練計画書_令和8年度.docx</code> が生成される。</span>
                </li>
                <li>
                    <strong>Word 文書を印刷して一括決裁を受ける</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;">消防長・次長・救急課長・係長・起案者の決裁欄に押印してもらう。</span>
                </li>
                <li>
                    <strong>node docs/sync-monthly-goals.js を実行する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;"><code>js/monthly-goals.js</code> が12ヶ月分のデータに更新される。</span>
                </li>
                <li>
                    <strong>git push でサイトをデプロイする</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;">数分後に GitHub Pages に反映される。</span>
                </li>
            </ol>

            <div class="note">
                <p class="note-title">以降は何もしなくてOK</p>
                <p>デプロイが完了すれば、月が変わるたびに自動で当月の訓練目標が表示されます。毎月の起案作業は不要です。</p>
            </div>
        </section>

        <!-- 3. 訓練内容の変更 -->
        <section id="edit-json" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
                3. 訓練内容の変更（JSON ファイル編集）
            </h2>
            <p>訓練内容を変更するには <strong>docs/annual-plan-2026.json</strong> を編集します。</p>

            <h3>編集例：4月の訓練目標を変更する場合</h3>
            <div class="code-label">docs/annual-plan-2026.json（抜粋）</div>
            <div class="code-block">
<span class="key">"2026-04"</span>: {<br>
&nbsp;&nbsp;<span class="key">"theme"</span>: <span class="string">"基本手技の習熟（年度初め基礎確認）"</span>,  <span class="comment">← 月のテーマ</span><br>
&nbsp;&nbsp;<span class="key">"goals"</span>: [<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"title"</span>: <span class="string">"バイタルサイン測定の確実な実施"</span>,  <span class="comment">← 目標のタイトル（サイトに表示）</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"description"</span>: <span class="string">"血圧・脈拍・SpO2・呼吸の正確な測定と報告手順を習得する"</span>  <span class="comment">← 詳細（サイトに表示）</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"title"</span>: <span class="string">"初期評価の流れの確認"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"description"</span>: <span class="string">"意識・気道・呼吸・循環の優先順位を意識した系統的な評価を行う"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;],<br>
&nbsp;&nbsp;<span class="key">"scenarios"</span>: [ <span class="string">"70代男性、胸部不快感..."</span> ],  <span class="comment">← Word文書にのみ反映</span><br>
&nbsp;&nbsp;<span class="key">"equipment"</span>: [ <span class="string">"血圧計"</span>, <span class="string">"SpO2モニター"</span> ],  <span class="comment">← Word文書にのみ反映</span><br>
&nbsp;&nbsp;<span class="key">"evaluation"</span>: [ <span class="string">"マンシェットのサイズ選択が適切"</span>, ... ]  <span class="comment">← Word文書にのみ反映</span><br>
}
            </div>

            <h3>サイトに表示される項目</h3>
            <table>
                <tr>
                    <th>フィールド</th>
                    <th>サイト表示</th>
                    <th>Word 文書</th>
                </tr>
                <tr>
                    <td><code>theme</code></td>
                    <td>—</td>
                    <td>年間計画表に表示</td>
                </tr>
                <tr>
                    <td><code>goals[].title</code></td>
                    <td><strong>表示される</strong>（太字）</td>
                    <td>年間計画表に表示</td>
                </tr>
                <tr>
                    <td><code>goals[].description</code></td>
                    <td><strong>表示される</strong></td>
                    <td>年間計画表に表示</td>
                </tr>
                <tr>
                    <td><code>scenarios</code></td>
                    <td>—</td>
                    <td>年間計画表に表示</td>
                </tr>
                <tr>
                    <td><code>equipment</code></td>
                    <td>—</td>
                    <td>年間計画表に表示</td>
                </tr>
                <tr>
                    <td><code>evaluation</code></td>
                    <td>—</td>
                    <td>年間計画表に表示</td>
                </tr>
            </table>

            <div class="warning">
                <p class="warning-title">JSON の書き方に注意</p>
                <p>JSON は書き方が厳密です。以下の点に注意してください。</p>
                <ul style="padding-left: 20px; margin-top: 8px;">
                    <li>文字列は必ず <strong>ダブルクォーテーション（"）</strong> で囲む</li>
                    <li>最後の項目の後に <strong>カンマ（,）は不要</strong></li>
                    <li>編集後は <a href="https://jsonlint.com" target="_blank" rel="noopener">jsonlint.com</a> でバリデーションを確認できる</li>
                </ul>
            </div>
        </section>

        <!-- 4. monthly-goals.js の更新 -->
        <section id="sync" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="1 4 1 10 7 10"/>
                    <path d="M3.51 15a9 9 0 1 0 .49-3.5"/>
                </svg>
                4. monthly-goals.js の更新（同期スクリプト実行）
            </h2>
            <p>JSON を編集したあと、以下のコマンドで <code>js/monthly-goals.js</code> を更新します。</p>

            <div class="code-label">コマンドプロンプト / ターミナル</div>
            <div class="code-block">
<span class="comment"># プロジェクトのフォルダに移動</span><br>
<span class="cmd">cd C:\Users\ryoji\Projects\fire-ems\ems-ojt-system</span><br>
<br>
<span class="comment"># スクリプトを実行</span><br>
<span class="cmd">node docs/sync-monthly-goals.js</span><br>
<br>
<span class="comment"># 成功すると以下のメッセージが表示される</span><br>
js/monthly-goals.js を更新しました（12ヶ月分）
            </div>

            <div class="note">
                <p class="note-title">Node.js が必要です</p>
                <p>Node.js がインストールされていない場合は <a href="https://nodejs.org" target="_blank" rel="noopener">nodejs.org</a> からインストールしてください（LTS 版を推奨）。</p>
            </div>
        </section>

        <!-- 5. 決裁用 Word 文書の生成 -->
        <section id="docx" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
                5. 決裁用 Word 文書の生成
            </h2>
            <p>訓練内容を変更した際や、次年度分を作成する際に実行します。</p>

            <h3>初回のみ：python-docx のインストール</h3>
            <div class="code-label">コマンドプロンプト</div>
            <div class="code-block">
<span class="cmd">pip install python-docx</span>
            </div>

            <h3>Word 文書の生成</h3>
            <div class="code-label">コマンドプロンプト</div>
            <div class="code-block">
<span class="cmd">python docs/generate-annual-plan.py</span><br>
<br>
<span class="comment"># 成功すると以下のメッセージが表示される</span><br>
Word文書を生成しました: ...docs\output\年間訓練計画書_令和8年度.docx
            </div>

            <h3>生成される文書の構成</h3>
            <table>
                <tr><th>章</th><th>内容</th></tr>
                <tr><td>表紙</td><td>件名・起案日・起案者</td></tr>
                <tr><td>1. 趣旨</td><td>年間計画策定の目的</td></tr>
                <tr><td>2. 訓練計画の概要</td><td>年度・対象者・実施頻度など</td></tr>
                <tr><td>3. 年間訓練計画表</td><td>12ヶ月分（月・テーマ・目標・評価基準）</td></tr>
                <tr><td>4. 実施要領</td><td>訓練形式・所要時間・記録方法など</td></tr>
                <tr><td>5. その他</td><td>プロトコル改訂時の対応等</td></tr>
                <tr><td>結び</td><td>「上記のとおり起案する。」</td></tr>
                <tr><td>決裁欄</td><td>消防長・次長・救急課長・係長・起案者</td></tr>
            </table>

            <div class="tip">
                <p class="tip-title">出力先</p>
                <p><code>docs/output/</code> フォルダに保存されます。このフォルダはGitの管理外（.gitignore）のため、Wordファイルはサイトには公開されません。</p>
            </div>
        </section>

        <!-- 6. GitHub へのデプロイ -->
        <section id="deploy" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 18 22 12 16 6"/>
                    <polyline points="8 6 2 12 8 18"/>
                </svg>
                6. GitHub へのデプロイ（サイト公開）
            </h2>
            <p><code>sync-monthly-goals.js</code> 実行後、以下のコマンドでサイトを更新します。</p>

            <div class="code-label">コマンドプロンプト / ターミナル</div>
            <div class="code-block">
<span class="comment"># 変更ファイルをステージング</span><br>
<span class="cmd">git add js/monthly-goals.js docs/annual-plan-2026.json</span><br>
<br>
<span class="comment"># コミット（メッセージは適宜変更）</span><br>
<span class="cmd">git commit -m "令和8年度訓練計画を更新"</span><br>
<br>
<span class="comment"># GitHub にプッシュ（数分後にサイトに反映）</span><br>
<span class="cmd">git push</span>
            </div>

            <div class="tip">
                <p class="tip-title">反映の確認</p>
                <p>push 後、数分待ってからサイト（<code>https://ryoji-ai.github.io/ems-ojt-system/</code>）にアクセスして確認してください。ブラウザのキャッシュが残っている場合は <strong>Ctrl+Shift+R</strong>（強制再読み込み）を行ってください。</p>
            </div>
        </section>

        <!-- 7. 翌年度への更新手順 -->
        <section id="next-year" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                </svg>
                7. 翌年度への更新手順
            </h2>
            <p>令和9年度（2027年4月〜2028年3月）に更新する場合の手順です。</p>

            <ol class="step-list">
                <li>
                    <strong>annual-plan-2026.json をコピーして annual-plan-2027.json を作成する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;">ファイルをコピーしてリネームする（エクスプローラーで操作可能）。</span>
                </li>
                <li>
                    <strong>annual-plan-2027.json を開いて内容を編集する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;">月のキーを <code>"2027-04"</code>〜<code>"2028-03"</code> に変更し、各月の訓練内容を更新する。冒頭の <code>fiscalYear</code>・<code>title</code> も変更する。</span>
                </li>
                <li>
                    <strong>sync-monthly-goals.js の読み込みファイル名を変更する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;"><code>docs/sync-monthly-goals.js</code> の1行目のファイル名を <code>annual-plan-2027.json</code> に変更する。</span>
                </li>
                <li>
                    <strong>generate-annual-plan.py の読み込みファイル名を変更する</strong><br>
                    <span style="color: var(--text-light); font-size: 0.9rem;"><code>docs/generate-annual-plan.py</code> の <code>PLAN_FILE</code> 変数のファイル名を <code>annual-plan-2027.json</code> に変更する。</span>
                </li>
                <li>
                    <strong>以降は年度初めの作業フロー（手順 2）と同じ</strong>
                </li>
            </ol>

            <h3>sync-monthly-goals.js の変更箇所</h3>
            <div class="code-label">docs/sync-monthly-goals.js（変更前）</div>
            <div class="code-block">
<span class="key">const</span> PLAN_FILE = path.join(__dirname, <span class="string">'annual-plan-2026.json'</span>);
            </div>
            <div class="code-label">docs/sync-monthly-goals.js（変更後）</div>
            <div class="code-block">
<span class="key">const</span> PLAN_FILE = path.join(__dirname, <span class="string">'annual-plan-2027.json'</span>);
            </div>
        </section>

        <!-- 8. JSON スキーマ リファレンス -->
        <section id="schema" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
                </svg>
                8. JSON スキーマ リファレンス
            </h2>
            <p>annual-plan-YYYY.json の各フィールドの意味と書き方です。</p>

            <h3>トップレベル</h3>
            <table>
                <tr><th>フィールド</th><th>型</th><th>説明</th></tr>
                <tr><td><code>fiscalYear</code></td><td>文字列</td><td>年度（例: <code>"2026"</code>）</td></tr>
                <tr><td><code>title</code></td><td>文字列</td><td>Word 文書のタイトル</td></tr>
                <tr><td><code>organization</code></td><td>文字列</td><td>組織名</td></tr>
                <tr><td><code>author</code></td><td>文字列</td><td>起案者の役職</td></tr>
                <tr><td><code>months</code></td><td>オブジェクト</td><td>月ごとの訓練データ（キーは <code>"YYYY-MM"</code> 形式）</td></tr>
            </table>

            <h3>months[キー] の各フィールド</h3>
            <table>
                <tr><th>フィールド</th><th>型</th><th>サイト表示</th><th>説明</th></tr>
                <tr>
                    <td><code>theme</code></td><td>文字列</td>
                    <td><span class="badge badge-yellow">Word のみ</span></td>
                    <td>その月のテーマ（例: 「基本手技の習熟」）</td>
                </tr>
                <tr>
                    <td><code>goals</code></td><td>配列</td>
                    <td><span class="badge badge-green">表示される</span></td>
                    <td>訓練目標の配列。<code>title</code> と <code>description</code> を持つ</td>
                </tr>
                <tr>
                    <td><code>goals[].title</code></td><td>文字列</td>
                    <td><span class="badge badge-green">表示される</span></td>
                    <td>目標のタイトル（太字で表示）</td>
                </tr>
                <tr>
                    <td><code>goals[].description</code></td><td>文字列</td>
                    <td><span class="badge badge-green">表示される</span></td>
                    <td>目標の詳細説明</td>
                </tr>
                <tr>
                    <td><code>scenarios</code></td><td>文字列の配列</td>
                    <td><span class="badge badge-yellow">Word のみ</span></td>
                    <td>訓練シナリオ（例: 「70代男性、胸部不快感...」）</td>
                </tr>
                <tr>
                    <td><code>equipment</code></td><td>文字列の配列</td>
                    <td><span class="badge badge-yellow">Word のみ</span></td>
                    <td>使用資器材リスト</td>
                </tr>
                <tr>
                    <td><code>evaluation</code></td><td>文字列の配列</td>
                    <td><span class="badge badge-yellow">Word のみ</span></td>
                    <td>評価基準（チェック項目）</td>
                </tr>
            </table>

            <h3>月キーの対応表（令和8年度）</h3>
            <table>
                <tr><th>月</th><th>キー</th><th>月</th><th>キー</th></tr>
                <tr><td>4月（令和8年）</td><td><code>"2026-04"</code></td><td>10月（令和8年）</td><td><code>"2026-10"</code></td></tr>
                <tr><td>5月</td><td><code>"2026-05"</code></td><td>11月</td><td><code>"2026-11"</code></td></tr>
                <tr><td>6月</td><td><code>"2026-06"</code></td><td>12月</td><td><code>"2026-12"</code></td></tr>
                <tr><td>7月</td><td><code>"2026-07"</code></td><td>1月（令和9年）</td><td><code>"2027-01"</code></td></tr>
                <tr><td>8月</td><td><code>"2026-08"</code></td><td>2月</td><td><code>"2027-02"</code></td></tr>
                <tr><td>9月</td><td><code>"2026-09"</code></td><td>3月</td><td><code>"2027-03"</code></td></tr>
            </table>
        </section>

        <!-- 9. トラブルシューティング -->
        <section id="trouble" class="section">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                9. トラブルシューティング
            </h2>

            <h3>よくあるエラー</h3>

            <div style="margin: 16px 0; padding: 16px; background: var(--bg-color); border-radius: 12px; border: 1px solid var(--border-light);">
                <p><strong>Q: node docs/sync-monthly-goals.js を実行したらエラーになる</strong></p>
                <p style="margin-top: 8px; color: var(--text-secondary);">A: JSON の書き方に誤りがある可能性があります。<a href="https://jsonlint.com" target="_blank" rel="noopener">jsonlint.com</a> に annual-plan-2026.json の内容を貼り付けてチェックしてください。</p>
            </div>

            <div style="margin: 16px 0; padding: 16px; background: var(--bg-color); border-radius: 12px; border: 1px solid var(--border-light);">
                <p><strong>Q: python docs/generate-annual-plan.py を実行したら「ModuleNotFoundError: No module named 'docx'」と出る</strong></p>
                <p style="margin-top: 8px; color: var(--text-secondary);">A: python-docx がインストールされていません。<code>pip install python-docx</code> を実行してください。</p>
            </div>

            <div style="margin: 16px 0; padding: 16px; background: var(--bg-color); border-radius: 12px; border: 1px solid var(--border-light);">
                <p><strong>Q: git push したのにサイトが変わらない</strong></p>
                <p style="margin-top: 8px; color: var(--text-secondary);">A: GitHub Pages の反映に数分かかる場合があります。また、ブラウザのキャッシュが原因のこともあります。<strong>Ctrl+Shift+R</strong>（強制再読み込み）を試してください。</p>
            </div>

            <div style="margin: 16px 0; padding: 16px; background: var(--bg-color); border-radius: 12px; border: 1px solid var(--border-light);">
                <p><strong>Q: 当月のデータがあるのにサイトに表示されない</strong></p>
                <p style="margin-top: 8px; color: var(--text-secondary);">A: monthly-goals.js のキーが正しくない可能性があります。キーは <code>"YYYY-MM"</code> 形式（例: <code>"2026-04"</code>）で、月は2桁（4月なら <code>04</code>）である必要があります。sync スクリプトを再実行して確認してください。</p>
            </div>

            <div style="margin: 16px 0; padding: 16px; background: var(--bg-color); border-radius: 12px; border: 1px solid var(--border-light);">
                <p><strong>Q: 「node」または「python」コマンドが見つからない</strong></p>
                <p style="margin-top: 8px; color: var(--text-secondary);">A: Node.js または Python がインストールされていません。Node.js は <a href="https://nodejs.org" target="_blank" rel="noopener">nodejs.org</a>、Python は <a href="https://www.python.org" target="_blank" rel="noopener">python.org</a> からインストールしてください。</p>
            </div>

            <h3>お問い合わせ</h3>
            <p>解決しない場合は、エラーメッセージのスクリーンショットを添えて管理担当者へご連絡ください。</p>
        </section>

        <footer class="footer">
            <p>&copy; 2026 総社市消防本部 救急OJT教育システム</p>
            <p style="margin-top: 8px;">管理者マニュアル 令和8年2月版</p>
        </footer>
    </div>
</body>
</html>
